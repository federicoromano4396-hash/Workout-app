<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Workout Tracker</title>
    
    <!-- Firebase SDKs -->
    <script type="module">
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js';
        import { getDatabase, ref, get, set, onValue } from 'https://www.gstatic.com/firebasejs/10.7.0/firebase-database.js';
        
        // Firebase configuration
        const firebaseConfig = {
            apiKey: "AIzaSyBzkjkN7Avrn8YSRFg8ut-6U23-BB7__tA",
            authDomain: "workout-tracker-11806.firebaseapp.com",
            databaseURL: "https://workout-tracker-11806-default-rtdb.firebaseio.com",
            projectId: "workout-tracker-11806",
            storageBucket: "workout-tracker-11806.firebasestorage.app",
            messagingSenderId: "759524107049",
            appId: "1:759524107049:web:25207f01012bbbb4c0cd38",
            measurementId: "G-H4LVRRK0MT"
        };
        
        // Initialize Firebase
        const app = initializeApp(firebaseConfig);
        const database = getDatabase(app);
        
        // Make Firebase functions globally available
        window.firebaseDB = database;
        window.firebaseRef = ref;
        window.firebaseGet = get;
        window.firebaseSet = set;
        window.firebaseOnValue = onValue;
        
        // Initialize the app after Firebase is loaded
        window.addEventListener('DOMContentLoaded', () => {
            window.initWorkoutApp();
        });
    </script>
    
    <style>
        *{margin:0;padding:0;box-sizing:border-box}
        body{font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,sans-serif;background:linear-gradient(135deg,#1e3c72 0%,#2a5298 100%);min-height:100vh;color:white}
        .container{max-width:900px;margin:0 auto;padding:20px}
        
        /* Page visibility control */
        .page{display:none}
        .page.active{display:block}
        
        .main-menu{text-align:center;padding:40px 20px}
        .main-title{font-size:3rem;font-weight:800;margin-bottom:10px;background:linear-gradient(45deg,#ff6b6b,#ffd93d,#6bcf7f,#4d79ff);background-size:300% 300%;-webkit-background-clip:text;-webkit-text-fill-color:transparent;animation:gradientShift 3s ease infinite}
        @keyframes gradientShift{0%,100%{background-position:0% 50%}50%{background-position:100% 50%}}
        .main-subtitle{font-size:1.2rem;opacity:0.8;margin-bottom:50px;font-weight:300}
        .workout-cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:25px;margin-bottom:40px}
        .workout-card{background:linear-gradient(135deg,rgba(255,255,255,0.1),rgba(255,255,255,0.05));backdrop-filter:blur(20px);border:1px solid rgba(255,255,255,0.2);border-radius:20px;padding:30px;cursor:pointer;transition:all 0.3s ease;position:relative;overflow:hidden}
        .workout-card:hover{transform:translateY(-5px);box-shadow:0 20px 40px rgba(0,0,0,0.3);border-color:rgba(255,255,255,0.4)}
        .workout-card.bicipiti{background:linear-gradient(135deg,#667eea 0%,#764ba2 100%)}
        .workout-card.petto-tricipiti{background:linear-gradient(135deg,#f093fb 0%,#f5576c 100%)}
        .workout-card.spalle-gambe{background:linear-gradient(135deg,#4facfe 0%,#00f2fe 100%)}
        .workout-icon{font-size:3rem;margin-bottom:15px;display:block}
        .workout-title{font-size:1.5rem;font-weight:700;margin-bottom:10px}
        .workout-info{opacity:0.9;font-size:0.95rem;line-height:1.4}
        
        .page-header{text-align:center;margin-bottom:30px;padding:30px;background:rgba(255,255,255,0.1);border-radius:20px;backdrop-filter:blur(10px)}
        .back-button{background:rgba(255,255,255,0.2);border:1px solid rgba(255,255,255,0.3);color:white;padding:10px 20px;border-radius:25px;cursor:pointer;font-size:0.9rem;font-weight:600;margin-bottom:20px;transition:all 0.3s ease}
        .back-button:hover{background:rgba(255,255,255,0.3);transform:translateX(-3px)}
        .page-title{font-size:2.5rem;font-weight:700;margin-bottom:10px}
        .page-subtitle{opacity:0.8;font-size:1.1rem}
        .exercise{background:rgba(255,255,255,0.95);border-radius:20px;padding:25px;margin-bottom:20px;box-shadow:0 10px 30px rgba(0,0,0,0.2);border:1px solid rgba(255,255,255,0.3);transition:transform 0.2s ease;color:#2c3e50}
        .exercise:hover{transform:translateY(-3px)}
        .exercise-name{font-size:1.4rem;font-weight:700;color:#2c3e50;margin-bottom:15px;display:flex;align-items:center}
        .exercise-number{width:35px;height:35px;background:linear-gradient(135deg,#3498db,#2980b9);border-radius:50%;margin-right:15px;display:flex;align-items:center;justify-content:center;color:white;font-weight:bold;font-size:1.1rem}
        .exercise-params{display:grid;grid-template-columns:repeat(auto-fit,minmax(150px,1fr));gap:15px;margin-bottom:15px}
        .param-group{background:#f8f9fa;padding:15px;border-radius:12px;border:2px solid transparent;transition:all 0.3s ease;position:relative}
        .param-group:focus-within{border-color:#3498db;box-shadow:0 0 0 3px rgba(52,152,219,0.1)}
        .param-group.timer-group{display:flex;flex-direction:column;align-items:center}
        .param-label{font-weight:600;color:#495057;margin-bottom:8px;font-size:0.85rem;text-transform:uppercase;letter-spacing:0.5px}
        .param-input{width:100%;padding:12px;border:2px solid #dee2e6;border-radius:8px;font-size:1rem;font-weight:600;transition:all 0.3s ease;background:white}
        .param-input:focus{outline:none;border-color:#3498db;box-shadow:0 0 0 3px rgba(52,152,219,0.1)}
        .param-input.saving{border-color:#f39c12;box-shadow:0 0 0 3px rgba(243,156,18,0.1)}
        .param-input.saved{border-color:#27ae60;box-shadow:0 0 0 3px rgba(39,174,96,0.1)}
        .timer-button{background:linear-gradient(135deg,#3498db,#2980b9);border:none;color:white;padding:8px 16px;border-radius:20px;cursor:pointer;font-size:0.9rem;font-weight:600;margin-top:8px;transition:all 0.3s ease;box-shadow:0 4px 15px rgba(52,152,219,0.3)}
        .timer-button:hover{transform:translateY(-2px);box-shadow:0 6px 20px rgba(52,152,219,0.4)}
        .timer-button.running{background:linear-gradient(135deg,#e74c3c,#c0392b);animation:pulse 1s infinite}
        .timer-display{font-size:1.2rem;font-weight:bold;color:#2c3e50;margin-top:5px;min-height:24px}
        .timer-display.active{color:#e74c3c;font-size:1.4rem}
        
        /* Serie Progress Dots */
        .series-progress{margin-top:15px;padding:15px;background:#f1f3f4;border-radius:10px}
        .series-label{font-size:0.9rem;font-weight:600;color:#495057;margin-bottom:10px;text-align:center}
        .progress-dots{display:flex;justify-content:center;align-items:center;gap:8px;flex-wrap:wrap}
        .progress-dot{width:16px;height:16px;border-radius:50%;border:2px solid #dee2e6;background:#ffffff;transition:all 0.3s ease;cursor:pointer;position:relative}
        .progress-dot:hover{transform:scale(1.1);border-color:#3498db}
        .progress-dot.completed{background:linear-gradient(135deg,#27ae60,#2ecc71);border-color:#27ae60;box-shadow:0 0 10px rgba(39,174,96,0.4)}
        .progress-dot.completed::after{content:'‚úì';position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);color:white;font-size:10px;font-weight:bold}
        .progress-dot.current{border-color:#e74c3c;background:#fff5f5;animation:currentDotPulse 1.5s infinite}
        @keyframes currentDotPulse{0%,100%{box-shadow:0 0 0 0 rgba(231,76,60,0.4)}50%{box-shadow:0 0 0 4px rgba(231,76,60,0.1)}}
        
        @keyframes pulse{0%,100%{transform:scale(1)}50%{transform:scale(1.05)}}
        .status-message{padding:15px 20px;border-radius:12px;margin:15px 0;font-weight:600;text-align:center;opacity:0;transition:opacity 0.3s ease}
        .status-message.success{background:rgba(212,237,218,0.9);color:#155724;border:1px solid rgba(195,230,203,0.5)}
        .status-message.error{background:rgba(248,215,218,0.9);color:#721c24;border:1px solid rgba(245,198,203,0.5)}
        .status-message.show{opacity:1}
        .loading-indicator{display:inline-block;margin-left:10px;font-size:0.9rem;opacity:0.7}
        @media (max-width:768px){.container{padding:15px}.main-title{font-size:2.5rem}.workout-cards{grid-template-columns:1fr;gap:20px}.exercise-params{grid-template-columns:1fr}}
    </style>
</head>
<body>
    <div class="container">
        <!-- HOME PAGE -->
        <div id="home-page" class="page active">
            <div class="main-menu">
                <div class="main-title">üí™ Workout Tracker</div>
                <div class="main-subtitle">Scegli la tua routine di allenamento</div>
                <div class="workout-cards">
                    <div class="workout-card bicipiti" onclick="showPage('bicipiti')">
                        <div class="workout-icon">üí™</div>
                        <div class="workout-title">Routine Bicipiti</div>
                        <div class="workout-info"><span>‚è± 30-45 min</span><br><span>üèãÔ∏è 5 esercizi</span></div>
                    </div>
                    <div class="workout-card petto-tricipiti" onclick="showPage('petto-tricipiti')">
                        <div class="workout-icon">üèãÔ∏è‚Äç‚ôÇÔ∏è</div>
                        <div class="workout-title">Petto & Tricipiti</div>
                        <div class="workout-info"><span>‚è± 45-60 min</span><br><span>üèãÔ∏è 4 esercizi</span></div>
                    </div>
                    <div class="workout-card spalle-gambe" onclick="showPage('spalle-gambe')">
                        <div class="workout-icon">ü¶µ</div>
                        <div class="workout-title">Spalle & Gambe</div>
                        <div class="workout-info"><span>‚è± 50-70 min</span><br><span>üèãÔ∏è 4 esercizi</span></div>
                    </div>
                </div>
            </div>
        </div>

        <div id="status-message" class="status-message"></div>
        
        <!-- BICIPITI PAGE -->
        <div id="bicipiti-page" class="page">
            <button class="back-button" onclick="showHomePage()">‚Üê Torna al Menu</button>
            <div class="page-header">
                <div class="page-title">üí™ Routine Bicipiti</div>
                <div class="page-subtitle">Frequenza: 1-2 volte a settimana ‚Ä¢ Durata: 30-45 minuti</div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">1</div>Barbell Curl (Curl con bilanciere)</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="barbell-curl" data-param="sets" value="4" min="1" max="10" onchange="updateSeriesProgress('barbell-curl')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="barbell-curl" data-param="reps" value="10-12"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="barbell-curl" data-param="weight" value="23" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="barbell-curl" data-param="rest" value="60" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('barbell-curl', 60)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-barbell-curl"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-barbell-curl"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">2</div>Hammer Curl (Curl martello)</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="hammer-curl" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('hammer-curl')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="hammer-curl" data-param="reps" value="11"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="hammer-curl" data-param="weight" value="12" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="hammer-curl" data-param="rest" value="60" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('hammer-curl', 60)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-hammer-curl"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-hammer-curl">
                        <span class="progress-dot" onclick="toggleSeries('hammer-curl', 1)" title="Serie 1">‚óã</span>
                        <span class="progress-dot" onclick="toggleSeries('hammer-curl', 2)" title="Serie 2">‚óã</span>
                        <span class="progress-dot" onclick="toggleSeries('hammer-curl', 3)" title="Serie 3">‚óã</span>
                    </div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">3</div>Incline Dumbbell Curl</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="incline-curl" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('incline-curl')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="incline-curl" data-param="reps" value="10"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="incline-curl" data-param="weight" value="10" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="incline-curl" data-param="rest" value="75" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('incline-curl', 75)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-incline-curl"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-incline-curl"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">4</div>Concentrated Curl</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="concentrated-curl" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('concentrated-curl')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="concentrated-curl" data-param="reps" value="8-10"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="concentrated-curl" data-param="weight" value="10" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="concentrated-curl" data-param="rest" value="52" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('concentrated-curl', 52)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-concentrated-curl"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-concentrated-curl"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">5</div>Zottman Curl</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="zottman-curl" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('zottman-curl')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="zottman-curl" data-param="reps" value="8-10"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="zottman-curl" data-param="weight" value="8" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="zottman-curl" data-param="rest" value="60" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('zottman-curl', 60)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-zottman-curl"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-zottman-curl"></div>
                </div>
            </div>
        </div>
        
        <!-- PETTO-TRICIPITI PAGE -->
        <div id="petto-tricipiti-page" class="page">
            <button class="back-button" onclick="showHomePage()">‚Üê Torna al Menu</button>
            <div class="page-header">
                <div class="page-title">üèãÔ∏è‚Äç‚ôÇÔ∏è Petto & Tricipiti</div>
                <div class="page-subtitle">Allenamento completo ‚Ä¢ Durata: 45-60 minuti</div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">1</div>Panca piana</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="bench-press" data-param="sets" value="4" min="1" max="10" onchange="updateSeriesProgress('bench-press')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="bench-press" data-param="reps" value="8-12"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="bench-press" data-param="weight" value="51" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="bench-press" data-param="rest" value="90" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('bench-press', 90)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-bench-press"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-bench-press"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">2</div>Croci su panca</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="flyes" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('flyes')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="flyes" data-param="reps" value="12-15"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="flyes" data-param="weight" value="8" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="flyes" data-param="rest" value="60" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('flyes', 60)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-flyes"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-flyes"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">3</div>French Press</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="french-press" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('french-press')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="french-press" data-param="reps" value="10-12"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="french-press" data-param="weight" value="8" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="french-press" data-param="rest" value="60" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('french-press', 60)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-french-press"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-french-press"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">4</div>Estensioni sopra la testa con manubrio</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="overhead-extension" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('overhead-extension')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="overhead-extension" data-param="reps" value="10-12"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="overhead-extension" data-param="weight" value="10" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="overhead-extension" data-param="rest" value="60" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('overhead-extension', 60)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-overhead-extension"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-overhead-extension"></div>
                </div>
            </div>
        </div>
        
        <!-- SPALLE-GAMBE PAGE -->
        <div id="spalle-gambe-page" class="page">
            <button class="back-button" onclick="showHomePage()">‚Üê Torna al Menu</button>
            <div class="page-header">
                <div class="page-title">ü¶µ Spalle & Gambe</div>
                <div class="page-subtitle">Allenamento completo ‚Ä¢ Durata: 50-70 minuti</div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">1</div>Squat con bilanciere</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="barbell-squat" data-param="sets" value="4" min="1" max="10" onchange="updateSeriesProgress('barbell-squat')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="barbell-squat" data-param="reps" value="10-12"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="barbell-squat" data-param="weight" value="55" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="barbell-squat" data-param="rest" value="120" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('barbell-squat', 120)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-barbell-squat"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-barbell-squat"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">2</div>Military Press</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="military-press" data-param="sets" value="4" min="1" max="10" onchange="updateSeriesProgress('military-press')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="military-press" data-param="reps" value="8-10"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="military-press" data-param="weight" value="30" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="military-press" data-param="rest" value="90" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('military-press', 90)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-military-press"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-military-press"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">3</div>Affondi in camminata con manubri</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="walking-lunges" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('walking-lunges')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="walking-lunges" data-param="reps" value="12-16"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="walking-lunges" data-param="weight" value="8" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="walking-lunges" data-param="rest" value="60" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('walking-lunges', 60)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-walking-lunges"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-walking-lunges"></div>
                </div>
            </div>
            
            <div class="exercise">
                <div class="exercise-name"><div class="exercise-number">4</div>Alzate laterali con manubri</div>
                <div class="exercise-params">
                    <div class="param-group"><div class="param-label">Serie</div><input type="number" class="param-input" data-exercise="lateral-raises" data-param="sets" value="3" min="1" max="10" onchange="updateSeriesProgress('lateral-raises')"></div>
                    <div class="param-group"><div class="param-label">Ripetizioni</div><input type="text" class="param-input" data-exercise="lateral-raises" data-param="reps" value="12-15"></div>
                    <div class="param-group"><div class="param-label">Peso (kg)</div><input type="number" class="param-input" data-exercise="lateral-raises" data-param="weight" value="6" min="0" max="999" step="0.5"></div>
                    <div class="param-group timer-group">
                        <div class="param-label">Riposo (sec)</div>
                        <input type="number" class="param-input" data-exercise="lateral-raises" data-param="rest" value="45" min="30" max="300">
                        <button class="timer-button" onclick="startTimer('lateral-raises', 45)">‚è± Avvia Timer</button>
                        <div class="timer-display" id="timer-lateral-raises"></div>
                    </div>
                </div>
                <div class="series-progress">
                    <div class="series-label">Progresso Serie</div>
                    <div class="progress-dots" id="progress-lateral-raises">
                        <span class="progress-dot" onclick="toggleSeries('lateral-raises', 1)" title="Serie 1">‚óã</span>
                        <span class="progress-dot" onclick="toggleSeries('lateral-raises', 2)" title="Serie 2">‚óã</span>
                        <span class="progress-dot" onclick="toggleSeries('lateral-raises', 3)" title="Serie 3">‚óã</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Global variables
        let workoutData = {};
        let isLoadingData = false;
        let activeTimers = {};
        let seriesProgress = {}; // Track completed series for each exercise
        
        // Initialize series progress tracking
        function initializeSeriesProgress() {
            const exercises = [
                'barbell-curl', 'hammer-curl', 'incline-curl', 'concentrated-curl', 'zottman-curl',
                'bench-press', 'flyes', 'french-press', 'overhead-extension',
                'barbell-squat', 'military-press', 'walking-lunges', 'lateral-raises'
            ];
            
            exercises.forEach(exercise => {
                if (!seriesProgress[exercise]) {
                    seriesProgress[exercise] = {
                        completed: 0,
                        total: 0
                    };
                }
            });
        }
        
        // Update series progress dots based on sets input
        function updateSeriesProgress(exerciseId) {
            const setsInput = document.querySelector(`[data-exercise="${exerciseId}"][data-param="sets"]`);
            const progressContainer = document.getElementById(`progress-${exerciseId}`);
            
            if (!setsInput || !progressContainer) return;
            
            const totalSets = parseInt(setsInput.value) || 0;
            
            // Update progress tracking
            if (!seriesProgress[exerciseId]) {
                seriesProgress[exerciseId] = { completed: 0, total: totalSets };
            } else {
                seriesProgress[exerciseId].total = totalSets;
                // Reset completed if total sets decreased below completed
                if (seriesProgress[exerciseId].completed > totalSets) {
                    seriesProgress[exerciseId].completed = totalSets;
                }
            }
            
            // Clear and rebuild dots
            progressContainer.innerHTML = '';
            
            for (let i = 0; i < totalSets; i++) {
                const dot = document.createElement('div');
                dot.className = 'progress-dot';
                dot.setAttribute('data-series', i + 1);
                dot.setAttribute('onclick', `toggleSeries('${exerciseId}', ${i + 1})`);
                dot.setAttribute('title', `Serie ${i + 1}`);
                
                // Mark completed series
                if (i < seriesProgress[exerciseId].completed) {
                    dot.classList.add('completed');
                }
                
                progressContainer.appendChild(dot);
            }
            
            // Save progress to Firebase
            if (!isLoadingData) {
                saveSeriesProgressToFirebase(exerciseId);
            }
        }
        
        // Toggle series completion manually (click on dot)
        function toggleSeries(exerciseId, seriesNumber) {
            if (!seriesProgress[exerciseId]) return;
            
            const progressContainer = document.getElementById(`progress-${exerciseId}`);
            const dots = progressContainer.querySelectorAll('.progress-dot');
            const dot = dots[seriesNumber - 1];
            
            if (dot.classList.contains('completed')) {
                // Uncomplete this series and all subsequent ones
                for (let i = seriesNumber - 1; i < dots.length; i++) {
                    dots[i].classList.remove('completed');
                }
                seriesProgress[exerciseId].completed = seriesNumber - 1;
            } else {
                // Complete this series and all previous ones
                for (let i = 0; i < seriesNumber; i++) {
                    dots[i].classList.add('completed');
                }
                seriesProgress[exerciseId].completed = seriesNumber;
            }
            
            saveSeriesProgressToFirebase(exerciseId);
        }
        
        // Complete next series when timer starts
        function completeNextSeries(exerciseId) {
            if (!seriesProgress[exerciseId]) return;
            
            const { completed, total } = seriesProgress[exerciseId];
            
            if (completed < total) {
                seriesProgress[exerciseId].completed = completed + 1;
                
                const progressContainer = document.getElementById(`progress-${exerciseId}`);
                const dots = progressContainer.querySelectorAll('.progress-dot');
                
                if (dots[completed]) {
                    dots[completed].classList.add('completed');
                }
                
                // Check if all series are completed
                if (seriesProgress[exerciseId].completed === total) {
                    showStatus(`üéâ Esercizio ${exerciseId} completato! Tutte le serie finite!`, 'success');
                } else {
                    showStatus(`‚úÖ Serie ${seriesProgress[exerciseId].completed}/${total} completata per ${exerciseId}`, 'success');
                }
                
                saveSeriesProgressToFirebase(exerciseId);
            }
        }
        
        // Save series progress to Firebase
        async function saveSeriesProgressToFirebase(exerciseId) {
            try {
                const dbRef = window.firebaseRef(window.firebaseDB, `seriesProgress/${exerciseId}`);
                await window.firebaseSet(dbRef, seriesProgress[exerciseId]);
                console.log(`Series progress saved for ${exerciseId}:`, seriesProgress[exerciseId]);
            } catch (error) {
                console.error('Error saving series progress:', error);
            }
        }
        
        // Load series progress from Firebase
        async function loadSeriesProgressFromFirebase() {
            try {
                const dbRef = window.firebaseRef(window.firebaseDB, 'seriesProgress');
                const snapshot = await window.firebaseGet(dbRef);
                
                if (snapshot.exists()) {
                    seriesProgress = snapshot.val();
                    console.log('Series progress loaded from Firebase:', seriesProgress);
                    
                    // Update all progress dots
                    Object.keys(seriesProgress).forEach(exerciseId => {
                        updateSeriesProgress(exerciseId);
                    });
                }
            } catch (error) {
                console.error('Error loading series progress:', error);
            }
        }
        
        // Reset all series progress for a workout
        function resetWorkoutProgress(workoutType) {
            const exercises = {
                'bicipiti': ['barbell-curl', 'hammer-curl', 'incline-curl', 'concentrated-curl', 'zottman-curl'],
                'petto-tricipiti': ['bench-press', 'flyes', 'french-press', 'overhead-extension'],
                'spalle-gambe': ['barbell-squat', 'military-press', 'walking-lunges', 'lateral-raises']
            };
            
            if (exercises[workoutType]) {
                exercises[workoutType].forEach(exerciseId => {
                    if (seriesProgress[exerciseId]) {
                        seriesProgress[exerciseId].completed = 0;
                        updateSeriesProgress(exerciseId);
                        saveSeriesProgressToFirebase(exerciseId);
                    }
                });
                showStatus(`üîÑ Reset progresso per ${workoutType}`, 'success');
            }
        }
        
        // Timer functionality
        function startTimer(exerciseId, defaultTime) {
            // Stop any existing timer for this exercise
            if (activeTimers[exerciseId]) {
                clearInterval(activeTimers[exerciseId].interval);
                delete activeTimers[exerciseId];
            }
            
            // Get the current rest time from the input field
            const restInput = document.querySelector(`[data-exercise="${exerciseId}"][data-param="rest"]`);
            const restTime = parseInt(restInput?.value) || defaultTime;
            
            const timerDisplay = document.getElementById(`timer-${exerciseId}`);
            const timerButton = document.querySelector(`[onclick="startTimer('${exerciseId}', ${defaultTime})"]`);
            
            if (!timerDisplay || !timerButton) return;
            
            // Complete next series immediately when timer starts
            completeNextSeries(exerciseId);
            
            let timeLeft = restTime;
            timerButton.textContent = '‚èπ Stop Timer';
            timerButton.classList.add('running');
            timerButton.setAttribute('onclick', `stopTimer('${exerciseId}', ${defaultTime})`);
            timerDisplay.classList.add('active');
            
            // Update display immediately
            updateTimerDisplay(timerDisplay, timeLeft);
            
            // Start countdown
            activeTimers[exerciseId] = {
                interval: setInterval(() => {
                    timeLeft--;
                    updateTimerDisplay(timerDisplay, timeLeft);
                    
                    if (timeLeft <= 0) {
                        // Timer finished
                        clearInterval(activeTimers[exerciseId].interval);
                        delete activeTimers[exerciseId];
                        
                        timerDisplay.textContent = '‚úÖ Riposo terminato!';
                        timerDisplay.style.color = '#27ae60';
                        timerButton.textContent = '‚è± Avvia Timer';
                        timerButton.classList.remove('running');
                        timerButton.setAttribute('onclick', `startTimer('${exerciseId}', ${defaultTime})`);
                        
                        // Show notification
                        showStatus('‚è∞ Timer terminato!', 'success');
                        
                        // Reset display after 3 seconds
                        setTimeout(() => {
                            timerDisplay.textContent = '';
                            timerDisplay.classList.remove('active');
                            timerDisplay.style.color = '';
                        }, 3000);
                    }
                }, 1000)
            };
        }
        
        function stopTimer(exerciseId, defaultTime) {
            if (activeTimers[exerciseId]) {
                clearInterval(activeTimers[exerciseId].interval);
                delete activeTimers[exerciseId];
            }
            
            const timerDisplay = document.getElementById(`timer-${exerciseId}`);
            const timerButton = document.querySelector(`[onclick="stopTimer('${exerciseId}', ${defaultTime})"]`);
            
            if (timerDisplay && timerButton) {
                timerDisplay.textContent = '';
                timerDisplay.classList.remove('active');
                timerDisplay.style.color = '';
                timerButton.textContent = '‚è± Avvia Timer';
                timerButton.classList.remove('running');
                timerButton.setAttribute('onclick', `startTimer('${exerciseId}', ${defaultTime})`);
            }
        }
        
        function updateTimerDisplay(display, timeLeft) {
            const minutes = Math.floor(timeLeft / 60);
            const seconds = timeLeft % 60;
            display.textContent = `${minutes}:${seconds.toString().padStart(2, '0')}`;
        }
        
        // Navigation functions
        function showPage(pageId) {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show selected page
            const targetPage = document.getElementById(pageId + '-page');
            if (targetPage) {
                targetPage.classList.add('active');
            }
        }
        
        function showHomePage() {
            // Hide all pages
            document.querySelectorAll('.page').forEach(page => {
                page.classList.remove('active');
            });
            
            // Show home page
            document.getElementById('home-page').classList.add('active');
            
            // Stop all active timers when returning to home
            Object.keys(activeTimers).forEach(exerciseId => {
                clearInterval(activeTimers[exerciseId].interval);
            });
            activeTimers = {};
        }
        
        // Initialize the workout app - Enhanced with debug info
        window.initWorkoutApp = async function() {
            console.log('üöÄ INIZIALIZZAZIONE APP...');
            console.log('üì± Device info:', {
                userAgent: navigator.userAgent,
                screenWidth: screen.width,
                viewportWidth: window.innerWidth,
                isMobile: window.innerWidth <= 768
            });
            
            // Verifica se Firebase √® caricato correttamente
            console.log('üîç Verifica Firebase:', {
                firebaseDB: !!window.firebaseDB,
                firebaseRef: !!window.firebaseRef,
                firebaseGet: !!window.firebaseGet,
                firebaseSet: !!window.firebaseSet,
                firebaseOnValue: !!window.firebaseOnValue
            });
            
            if (!window.firebaseDB || !window.firebaseRef || !window.firebaseGet || !window.firebaseSet) {
                console.error('‚ùå FIREBASE NON CARICATO CORRETTAMENTE!');
                showStatus('‚ùå Errore: Firebase non caricato', 'error');
                return;
            }
            
            showStatus('üì° Caricamento dati da Firebase...', 'success');
            
            // Initialize series progress
            initializeSeriesProgress();
            
            // Load data
            await loadAllDataFromFirebase();
            await loadSeriesProgressFromFirebase();
            
            // Initialize progress dots for all exercises with debug
            const exercises = [
                'barbell-curl', 'hammer-curl', 'incline-curl', 'concentrated-curl', 'zottman-curl',
                'bench-press', 'flyes', 'french-press', 'overhead-extension',
                'barbell-squat', 'military-press', 'walking-lunges', 'lateral-raises'
            ];
            
            console.log('üîÑ Inizializzazione pallini per', exercises.length, 'esercizi...');
            
            exercises.forEach((exerciseId, index) => {
                console.log(`Inizializzando pallini per esercizio ${index + 1}/${exercises.length}: ${exerciseId}`);
                updateSeriesProgress(exerciseId);
                
                // Verify dots were created
                const container = document.getElementById(`progress-${exerciseId}`);
                const dots = container ? container.querySelectorAll('.progress-dot') : [];
                console.log(`Esercizio ${exerciseId}: ${dots.length} pallini creati`);
            });
            
            // Final verification
            setTimeout(() => {
                console.log('üîç Verifica finale pallini:');
                exercises.forEach(exerciseId => {
                    const container = document.getElementById(`progress-${exerciseId}`);
                    const dots = container ? container.querySelectorAll('.progress-dot') : [];
                    const setsInput = document.querySelector(`[data-exercise="${exerciseId}"][data-param="sets"]`);
                    const expectedDots = setsInput ? parseInt(setsInput.value) : 0;
                    
                    if (dots.length !== expectedDots) {
                        console.warn(`‚ö†Ô∏è Problema con ${exerciseId}: attesi ${expectedDots} pallini, trovati ${dots.length}`);
                        // Try to fix
                        updateSeriesProgress(exerciseId);
                    } else {
                        console.log(`‚úÖ ${exerciseId}: ${dots.length} pallini OK`);
                    }
                });
            }, 1000);
        };
        
        // Load all workout data from Firebase
        async function loadAllDataFromFirebase() {
            try {
                isLoadingData = true;
                showStatus('üì° Connessione a Firebase...', 'success');
                
                // Read from Firebase
                const dbRef = window.firebaseRef(window.firebaseDB, 'workouts');
                const snapshot = await window.firebaseGet(dbRef);
                
                if (snapshot.exists()) {
                    workoutData = snapshot.val();
                    console.log('‚úÖ DATI CARICATI DA FIREBASE:', workoutData);
                    showStatus('‚úÖ Dati caricati da Firebase!', 'success');
                } else {
                    console.log('‚ö†Ô∏è Nessun dato trovato su Firebase, inizializzo con valori predefiniti');
                    // Initialize with default data if no data exists
                    workoutData = {
                        'barbell-curl': { sets: '4', reps: '10-12', weight: '23', rest: '60' },
                        'hammer-curl': { sets: '3', reps: '11', weight: '12', rest: '60' },
                        'incline-curl': { sets: '3', reps: '10', weight: '10', rest: '75' },
                        'concentrated-curl': { sets: '3', reps: '8-10', weight: '10', rest: '52' },
                        'zottman-curl': { sets: '3', reps: '8-10', weight: '8', rest: '60' },
                        'bench-press': { sets: '4', reps: '8-12', weight: '51', rest: '90' },
                        'flyes': { sets: '3', reps: '12-15', weight: '8', rest: '60' },
                        'french-press': { sets: '3', reps: '10-12', weight: '8', rest: '60' },
                        'overhead-extension': { sets: '3', reps: '10-12', weight: '10', rest: '60' },
                        'barbell-squat': { sets: '4', reps: '10-12', weight: '55', rest: '120' },
                        'military-press': { sets: '4', reps: '8-10', weight: '30', rest: '90' },
                        'walking-lunges': { sets: '3', reps: '12-16', weight: '8', rest: '60' },
                        'lateral-raises': { sets: '3', reps: '12-15', weight: '6', rest: '45' }
                    };
                    await saveAllDataToFirebase();
                    showStatus('üîß Dati iniziali salvati su Firebase', 'success');
                }
                
                // Update all input fields with loaded data
                updateAllInputFields();
                
            } catch (error) {
                console.error('‚ùå ERRORE CONNESSIONE FIREBASE:', error);
                showStatus('‚ùå Errore connessione Firebase: ' + error.message, 'error');
                
                // Log configurazione Firebase per debug
                console.error('Configurazione Firebase:', {
                    database: window.firebaseDB,
                    ref: window.firebaseRef,
                    get: window.firebaseGet,
                    set: window.firebaseSet
                });
            } finally {
                isLoadingData = false;
            }
        }
        
        // Save all data to Firebase
        async function saveAllDataToFirebase() {
            try {
                const dbRef = window.firebaseRef(window.firebaseDB, 'workouts');
                await window.firebaseSet(dbRef, workoutData);
                console.log('Tutti i dati salvati su Firebase');
            } catch (error) {
                console.error('Errore nel salvataggio su Firebase:', error);
                showStatus('Errore nel salvataggio su Firebase', 'error');
            }
        }
        
        // Save specific exercise data to Firebase
        async function saveExerciseToFirebase(exercise, param, value) {
            try {
                console.log(`üöÄ TENTATIVO SALVATAGGIO: ${exercise}.${param} = ${value}`);
                
                if (!workoutData[exercise]) {
                    workoutData[exercise] = {};
                }
                
                workoutData[exercise][param] = value;
                workoutData[exercise].updated = new Date().toLocaleString('it-IT');
                
                console.log('üîß Stato Firebase prima del salvataggio:', {
                    database: !!window.firebaseDB,
                    ref: !!window.firebaseRef,
                    set: !!window.firebaseSet,
                    
                });
                
                const dbRef = window.firebaseRef(window.firebaseDB, `workouts/${exercise}`);
                console.log('üîç Path Firebase:', `workouts/${exercise}`);
                console.log('üì¶ Dati da salvare:', workoutData[exercise]);
                
                await window.firebaseSet(dbRef, workoutData[exercise]);
                
                console.log(`‚úÖ SALVATO SU FIREBASE: ${exercise}.${param} = ${value}`);
                console.log('üìä Dati completi salvati:', workoutData[exercise]);
                
                // Mostra messaggio di conferma specifico per ogni parametro
                if (param === 'sets') {
                    showStatus(`‚úÖ Serie salvate su Firebase: ${exercise} = ${value} serie`, 'success');
                } else if (param === 'weight') {
                    showStatus(`‚úÖ Peso salvato su Firebase: ${exercise} = ${value}kg`, 'success');
                } else if (param === 'reps') {
                    showStatus(`‚úÖ Ripetizioni salvate su Firebase: ${exercise} = ${value}`, 'success');
                } else if (param === 'rest') {
                    showStatus(`‚úÖ Riposo salvato su Firebase: ${exercise} = ${value}s`, 'success');
                } else {
                    showStatus(`‚úÖ ${param} salvato su Firebase`, 'success');
                }
                
            } catch (error) {
                console.error('‚ùå ERRORE FIREBASE COMPLETO:', error);
                console.error('‚ùå Tipo errore:', error.name);
                console.error('‚ùå Messaggio:', error.message);
                console.error('‚ùå Codice errore:', error.code);
                console.error('‚ùå Stack:', error.stack);
                
                // Verifica stato Firebase
                console.error('üîç Debug Firebase:', {
                    hasDatabase: !!window.firebaseDB,
                    hasRef: !!window.firebaseRef,
                    hasSet: !!window.firebaseSet,
                    exercise,
                    param,
                    value,
                    dataToSave: workoutData[exercise]
                });
                
                // Messaggio di errore pi√π specifico
                let errorMsg = 'Errore Firebase';
                if (error.code === 'PERMISSION_DENIED') {
                    errorMsg = 'Errore: Permessi Firebase negati';
                } else if (error.code === 'NETWORK_ERROR') {
                    errorMsg = 'Errore: Connessione di rete';
                } else if (error.message) {
                    errorMsg = `Errore: ${error.message}`;
                }
                
                showStatus(`‚ùå ${errorMsg}`, 'error');
            }
        }
        
        // Update all input fields with current data
        function updateAllInputFields() {
            Object.keys(workoutData).forEach(exercise => {
                const data = workoutData[exercise];
                if (data) {
                    ['sets', 'reps', 'weight', 'rest'].forEach(param => {
                        const input = document.querySelector(`[data-exercise="${exercise}"][data-param="${param}"]`);
                        if (input && data[param]) {
                            input.value = data[param];
                        }
                    });
                }
            });
        }
        
        function showStatus(message, type) {
            const statusEl = document.getElementById('status-message');
            statusEl.textContent = message;
            statusEl.className = `status-message ${type} show`;
            setTimeout(() => statusEl.classList.remove('show'), 3000);
        }
        
        // Auto-save functionality
        document.addEventListener('input', async (e) => {
            if (e.target.classList.contains('param-input') && !isLoadingData) {
                const exercise = e.target.dataset.exercise;
                const param = e.target.dataset.param;
                const value = e.target.value;
                
                // Visual feedback
                e.target.classList.add('saving');
                
                try {
                    await saveExerciseToFirebase(exercise, param, value);
                    
                    e.target.classList.remove('saving');
                    e.target.classList.add('saved');
                    
                    setTimeout(() => e.target.classList.remove('saved'), 1000);
                    
                    // If sets changed, update progress dots
                    if (param === 'sets') {
                        updateSeriesProgress(exercise);
                    }
                    
                } catch (error) {
                    e.target.classList.remove('saving');
                    console.error('Errore nel salvataggio:', error);
                }
            }
        });
    </script>
</body>
</html>
